<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contractor Capacity Investment Calculator | KMJK</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1800px;
            margin: 0 auto;
        }

        .header {
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 3em;
            color: #667eea;
            margin-bottom: 10px;
        }

        .header .subtitle {
            font-size: 1.3em;
            color: #666;
        }

        .controls {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            margin-bottom: 30px;
        }

        .control-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .control-group label {
            font-weight: 600;
            margin-bottom: 8px;
            color: #667eea;
            font-size: 1.1em;
            display: block;
        }

        .control-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1.1em;
        }

        .control-group input:focus {
            outline: none;
            border-color: #667eea;
        }

        .capacity-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .capacity-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            border-left: 6px solid #667eea;
        }

        .capacity-card h3 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.4em;
            text-align: center;
        }

        .capacity-metric {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }

        .capacity-metric:last-child {
            border-bottom: none;
            padding-top: 15px;
            margin-top: 10px;
            border-top: 3px solid #eee;
        }

        .metric-label {
            color: #666;
            font-size: 0.95em;
        }

        .metric-value {
            font-weight: bold;
            color: #1e3c72;
        }

        .metric-value.positive {
            color: #27ae60;
        }

        .metric-value.negative {
            color: #e74c3c;
        }

        .filters {
            background: white;
            padding: 25px 30px;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            margin-bottom: 30px;
        }

        .filter-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .filter-group select {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
        }

        .filter-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .table-container {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        thead {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
        }

        th {
            padding: 15px;
            text-align: left;
            font-weight: 600;
            font-size: 0.9em;
            text-transform: uppercase;
        }

        td {
            padding: 12px 15px;
            border-bottom: 1px solid #f0f0f0;
        }

        tbody tr:hover {
            background-color: #f8f9ff;
        }

        .profitable {
            background-color: #d4edda;
            color: #155724;
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: bold;
        }

        .unprofitable {
            background-color: #f8d7da;
            color: #721c24;
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üíº Contractor Capacity Investment Calculator</h1>
            <p class="subtitle">Calculate ad investment needed to keep each contractor type fully busy</p>
        </div>

        <div class="controls">
            <h2 style="margin-bottom: 20px; color: #667eea;">‚öôÔ∏è Conversion Parameters</h2>
            <div class="control-grid">
                <div class="control-group">
                    <label>CTR (Click-Through Rate %)</label>
                    <input type="number" id="ctr" value="5.0" step="0.1" min="0">
                </div>
                <div class="control-group">
                    <label>CVR (Click to Lead %)</label>
                    <input type="number" id="cvr" value="6.5" step="0.1" min="0">
                </div>
                <div class="control-group">
                    <label>Close Rate (%)</label>
                    <input type="number" id="close-rate" value="35.0" step="0.1" min="0">
                </div>
                <div class="control-group">
                    <label>Your Commission Rate (%)</label>
                    <input type="number" id="commission-rate" value="15.0" step="0.1" min="0">
                </div>
            </div>
        </div>

        <div class="capacity-cards" id="capacity-cards">
            <!-- Capacity cards will be generated here -->
        </div>

        <div class="filters">
            <h2 style="margin-bottom: 15px; color: #667eea;">üîç Keyword Filters</h2>
            <div class="filter-row">
                <div class="filter-group">
                    <label>Category</label>
                    <select id="category-filter">
                        <option value="all">All Categories</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Profitability</label>
                    <select id="profit-filter">
                        <option value="all">All Keywords</option>
                        <option value="profitable">Profitable Only</option>
                        <option value="unprofitable">Unprofitable Only</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Sort By</label>
                    <select id="sort-by">
                        <option value="intent-desc">Intent Score (High to Low)</option>
                        <option value="roas-desc">True ROAS (High to Low)</option>
                        <option value="profit-desc">Profit Per Job (High to Low)</option>
                        <option value="cost-asc">Cost Per Job (Low to High)</option>
                        <option value="size-desc">Project Size (High to Low)</option>
                        <option value="volume-desc">Search Volume (High to Low)</option>
                        <option value="cpc-asc">CPC (Low to High)</option>
                    </select>
                </div>
            </div>
        </div>

        <div class="table-container">
            <h2 style="margin-bottom: 20px; color: #667eea;">üìã Keyword Investment Analysis</h2>
            <table>
                <thead>
                    <tr>
                        <th>Category</th>
                        <th>Keyword</th>
                        <th>Search Vol</th>
                        <th>CPC</th>
                        <th>Intent Score</th>
                        <th>Project Size</th>
                        <th>Adj. Job Value</th>
                        <th>Cost Per Job</th>
                        <th>Commission</th>
                        <th>Profit Per Job</th>
                        <th>True ROAS</th>
                    </tr>
                </thead>
                <tbody id="table-body">
                    <!-- Data will be inserted here -->
                </tbody>
            </table>
        </div>
    </div>

    <script>
const keywordData = [
  {keyword:'kitchen and toilet renovation',searchVol:50,cpc:0,category:'Full Bathroom Renovation'},
  {keyword:'kitchen renovation contractors',searchVol:50000,cpc:0.44,category:'Full Kitchen Renovation'},
  {keyword:'kitchen and bath remodeling contractors near me',searchVol:5000,cpc:0.76,category:'Full Kitchen Renovation'},
  {keyword:'kitchen renovation',searchVol:500000,cpc:1.04,category:'Full Kitchen Renovation'},
  {keyword:'kitchen reno',searchVol:500000,cpc:1.04,category:'Full Kitchen Renovation'},
  {keyword:'kitchen remodel contractors',searchVol:500000,cpc:1.08,category:'Full Kitchen Renovation'},
  {keyword:'contractor for kitchen remodel',searchVol:500000,cpc:1.08,category:'Full Kitchen Renovation'},
  {keyword:'kitchen renovation services',searchVol:5000,cpc:0.84,category:'Full Kitchen Renovation'},
  {keyword:'kitchen makeovers',searchVol:50000,cpc:1.25,category:'Full Kitchen Renovation'},
  {keyword:'l shaped kitchen remodel',searchVol:500,cpc:0.64,category:'Full Kitchen Renovation'},
  {keyword:'kitchen cabinet refacers near me',searchVol:50000,cpc:0.44,category:'Partial Kitchen (Cabinets)'},
  {keyword:'kitchen and bathroom renovations',searchVol:5000,cpc:1.32,category:'Full Kitchen Renovation'},
  {keyword:'kitchen and bath renovation',searchVol:5000,cpc:1.32,category:'Full Kitchen Renovation'},
  {keyword:'kitchen remodeling',searchVol:500000,cpc:1.75,category:'Full Kitchen Renovation'},
  {keyword:'kitchen and bath contractors near me',searchVol:5000,cpc:1.45,category:'Full Kitchen Renovation'},
  {keyword:'kitchen redesign',searchVol:5000,cpc:1.56,category:'Full Kitchen Renovation'},
  {keyword:'bathroom remodel companies near me',searchVol:50000,cpc:0.74,category:'Full Bathroom Renovation'},
  {keyword:'bath remodeling companies near me',searchVol:50000,cpc:0.74,category:'Full Bathroom Renovation'},
  {keyword:'bath remodel contractors near me',searchVol:50000,cpc:0.74,category:'Full Bathroom Renovation'},
  {keyword:'bathroom remodel contractors',searchVol:500000,cpc:0.83,category:'Full Bathroom Renovation'},
  {keyword:'bathroom renovation contractors',searchVol:500000,cpc:0.83,category:'Full Bathroom Renovation'},
  {keyword:'remodeling bathroom contractors',searchVol:500000,cpc:0.83,category:'Full Bathroom Renovation'},
  {keyword:'luxury kitchen remodel',searchVol:5000,cpc:2.14,category:'Full Kitchen Renovation'},
  {keyword:'kitchen cabinet remodel',searchVol:500000,cpc:1.64,category:'Partial Kitchen (Cabinets)'},
  {keyword:'kitchen cabinet renovation',searchVol:500000,cpc:1.64,category:'Partial Kitchen (Cabinets)'},
  {keyword:'kitchen and bathroom contractors',searchVol:5000,cpc:2.31,category:'Full Kitchen Renovation'},
  {keyword:'kitchen and bath contractors',searchVol:5000,cpc:2.31,category:'Full Kitchen Renovation'},
  {keyword:'modern kitchen remodel',searchVol:5000,cpc:2.62,category:'Full Kitchen Renovation'},
  {keyword:'modern kitchen renovation',searchVol:5000,cpc:2.62,category:'Full Kitchen Renovation'},
  {keyword:'small kitchen renovation',searchVol:5000,cpc:1.95,category:'Small Kitchen Renovation'},
  {keyword:'small kitchen reno',searchVol:5000,cpc:1.95,category:'Small Kitchen Renovation'},
  {keyword:'kitchen remodel cost',searchVol:50000,cpc:3.68,category:'Full Kitchen Renovation'},
  {keyword:'kitchen renovation costs',searchVol:50000,cpc:3.68,category:'Full Kitchen Renovation'},
  {keyword:'kitchen redesign cost',searchVol:50000,cpc:3.68,category:'Full Kitchen Renovation'},
  {keyword:'kitchen reno cost',searchVol:50000,cpc:3.68,category:'Full Kitchen Renovation'},
  {keyword:'kitchen remodel prices',searchVol:50000,cpc:3.68,category:'Full Kitchen Renovation'},
  {keyword:'small kitchen makeovers',searchVol:5000,cpc:1.99,category:'Small Kitchen Renovation'},
  {keyword:'new kitchen cost',searchVol:5000,cpc:3.16,category:'Full Kitchen Renovation'},
  {keyword:'simple kitchen remodel',searchVol:500,cpc:2.15,category:'Full Kitchen Renovation'},
  {keyword:'kitchen cabinet makeover',searchVol:5000,cpc:1.85,category:'Partial Kitchen (Cabinets)'},
  {keyword:'white kitchen remodel',searchVol:500,cpc:2.23,category:'Full Kitchen Renovation'},
  {keyword:'planning a kitchen remodel',searchVol:5000,cpc:3.40,category:'Full Kitchen Renovation'},
  {keyword:'updating kitchen cabinets',searchVol:5000,cpc:1.97,category:'Partial Kitchen (Cabinets)'},
  {keyword:'small kitchen remodel',searchVol:50000,cpc:3.24,category:'Small Kitchen Renovation'},
  {keyword:'top kitchen remodeling companies',searchVol:500,cpc:2.38,category:'Full Kitchen Renovation'},
  {keyword:'average cost of new kitchen',searchVol:500,cpc:2.99,category:'Full Kitchen Renovation'},
  {keyword:'kitchen upgrades on a budget',searchVol:500,cpc:2.47,category:'Full Kitchen Renovation'},
  {keyword:'raised ranch kitchen remodel',searchVol:500,cpc:3.86,category:'Full Kitchen Renovation'},
  {keyword:'average kitchen remodel cost',searchVol:5000,cpc:4.23,category:'Full Kitchen Renovation'},
  {keyword:'new kitchen remodel',searchVol:5000,cpc:4.29,category:'Full Kitchen Renovation'},
  {keyword:'kitchen upgrade cost',searchVol:5000,cpc:4.50,category:'Full Kitchen Renovation'},
  {keyword:'u shaped kitchen remodel',searchVol:500,cpc:4.10,category:'Full Kitchen Renovation'},
  {keyword:'new kitchen cabinets and countertops cost',searchVol:500,cpc:1.64,category:'Partial Kitchen (Cabinets)'},
  {keyword:'kitchen and bath remodeling',searchVol:50000,cpc:5.90,category:'Full Kitchen Renovation'},
  {keyword:'kitchen and bathroom remodeling',searchVol:50000,cpc:5.90,category:'Full Kitchen Renovation'},
  {keyword:'kitchen island makeover',searchVol:500,cpc:1.75,category:'Partial Kitchen (Cabinets)'},
  {keyword:'kitchen countertop makeover',searchVol:500,cpc:1.98,category:'Partial Kitchen (Cabinets)'},
  {keyword:'small kitchen makeovers on a budget',searchVol:500,cpc:2.48,category:'Small Kitchen Renovation'},
  {keyword:'kitchen upgrade',searchVol:5000,cpc:5.27,category:'Full Kitchen Renovation'},
  {keyword:'kitchen remodel companies near me',searchVol:50000,cpc:7.59,category:'Full Kitchen Renovation'},
  {keyword:'kitchen renovation companies near me',searchVol:50000,cpc:7.59,category:'Full Kitchen Renovation'},
  {keyword:'kitchen remodel near me',searchVol:500000,cpc:7.70,category:'Full Kitchen Renovation'},
  {keyword:'kitchen renovation near me',searchVol:500000,cpc:7.70,category:'Full Kitchen Renovation'},
  {keyword:'kitchen renovation services near me',searchVol:500,cpc:2.10,category:'Full Kitchen Renovation'},
  {keyword:'yelp kitchen remodel',searchVol:50,cpc:4.38,category:'Full Kitchen Renovation'},
  {keyword:'updating kitchen cabinets on a budget',searchVol:500,cpc:2.50,category:'Partial Kitchen (Cabinets)'},
  {keyword:'jacuzzi bathroom remodel',searchVol:50000,cpc:2.88,category:'Full Bathroom Renovation'},
  {keyword:'kitchen and bath remodeling contractors',searchVol:5000,cpc:4.74,category:'Full Kitchen Renovation'},
  {keyword:'new kitchen on a budget',searchVol:50,cpc:4.75,category:'Full Kitchen Renovation'},
  {keyword:'new small kitchen cost',searchVol:50,cpc:3.66,category:'Small Kitchen Renovation'},
  {keyword:'update kitchen countertops',searchVol:500,cpc:3.09,category:'Partial Kitchen (Cabinets)'},
  {keyword:'small condo kitchen remodel',searchVol:500,cpc:3.86,category:'Small Kitchen Renovation'},
  {keyword:'new kitchen and bathroom',searchVol:500,cpc:5.79,category:'Full Kitchen Renovation'},
  {keyword:'quick kitchen remodel',searchVol:50,cpc:6.06,category:'Full Kitchen Renovation'},
  {keyword:'bathroom remodeling',searchVol:500000,cpc:4.10,category:'Full Bathroom Renovation'},
  {keyword:'bathroom reconstruction',searchVol:500000,cpc:4.10,category:'Full Bathroom Renovation'},
  {keyword:'bathroom remodel bathtub',searchVol:500000,cpc:4.10,category:'Full Bathroom Renovation'},
  {keyword:'kitchen remodel designer',searchVol:5000,cpc:9.39,category:'Full Kitchen Renovation'},
  {keyword:'remodeling your kitchen',searchVol:500,cpc:8.27,category:'Full Kitchen Renovation'},
  {keyword:'kitchen island remodel',searchVol:5000,cpc:4.77,category:'Partial Kitchen (Cabinets)'},
  {keyword:'kitchen cabinet refurbishing',searchVol:5000,cpc:4.90,category:'Partial Kitchen (Cabinets)'},
  {keyword:'remodel my kitchen',searchVol:500,cpc:8.69,category:'Full Kitchen Renovation'},
  {keyword:'renovate my kitchen',searchVol:500,cpc:8.69,category:'Full Kitchen Renovation'},
  {keyword:'townhouse kitchen remodel',searchVol:5000,cpc:8.64,category:'Full Kitchen Renovation'},
  {keyword:'jacuzzi bath remodel cost',searchVol:50000,cpc:5.45,category:'Full Bathroom Renovation'},
  {keyword:'new kitchen cabinets and countertops',searchVol:500,cpc:5.13,category:'Partial Kitchen (Cabinets)'},
  {keyword:'small bathroom remodel',searchVol:50000,cpc:4.35,category:'Small Bathroom Renovation'},
  {keyword:'small bathroom renovations',searchVol:50000,cpc:4.35,category:'Small Bathroom Renovation'},
  {keyword:'small bathroom redo',searchVol:50000,cpc:4.35,category:'Small Bathroom Renovation'},
  {keyword:'bathroom remodels for small bathrooms',searchVol:50000,cpc:4.35,category:'Small Bathroom Renovation'},
  {keyword:'kitchen remodeling contractors near me',searchVol:50000,cpc:17.22,category:'Full Kitchen Renovation'},
  {keyword:'average bathroom remodel cost',searchVol:50000,cpc:5.95,category:'Full Bathroom Renovation'},
  {keyword:'typical bathroom remodel cost',searchVol:50000,cpc:5.95,category:'Full Bathroom Renovation'},
  {keyword:'average cost to redo a bathroom',searchVol:50000,cpc:5.95,category:'Full Bathroom Renovation'},
  {keyword:'san francisco kitchen remodel',searchVol:500,cpc:9.52,category:'Full Kitchen Renovation'},
  {keyword:'bathroom remodel cost',searchVol:50000,cpc:6.37,category:'Full Bathroom Renovation'},
  {keyword:'bathroom renovation cost',searchVol:50000,cpc:6.37,category:'Full Bathroom Renovation'},
  {keyword:'bath remodel cost',searchVol:50000,cpc:6.37,category:'Full Bathroom Renovation'},
  {keyword:'redoing kitchen cabinets',searchVol:500,cpc:6.16,category:'Partial Kitchen (Cabinets)'},
  {keyword:'replacing kitchen cabinets and countertops',searchVol:500,cpc:6.50,category:'Partial Kitchen (Cabinets)'},
  {keyword:'partial kitchen remodel',searchVol:500,cpc:6.69,category:'Partial Kitchen (Cabinets)'},
  {keyword:'partial kitchen renovation',searchVol:500,cpc:6.69,category:'Partial Kitchen (Cabinets)'},
  {keyword:'small kitchen renovation cost',searchVol:5000,cpc:6.61,category:'Small Kitchen Renovation'},
  {keyword:'small kitchen remodel cost',searchVol:5000,cpc:6.61,category:'Small Kitchen Renovation'},
  {keyword:'kitchen cabinet refaced',searchVol:5000,cpc:6.83,category:'Partial Kitchen (Cabinets)'},
  {keyword:'kitchen countertop remodel',searchVol:5000,cpc:7.36,category:'Partial Kitchen (Cabinets)'},
  {keyword:'jacuzzi bath remodel',searchVol:50000,cpc:8.85,category:'Full Bathroom Renovation'},
  {keyword:'kitchen renovation specialist',searchVol:500,cpc:7.64,category:'Full Kitchen Renovation'},
  {keyword:'best bathroom remodelers near me',searchVol:5000,cpc:4.95,category:'Full Bathroom Renovation'},
  {keyword:'kitchen cabinet remodel cost',searchVol:500,cpc:4.62,category:'Partial Kitchen (Cabinets)'},
  {keyword:'kitchen cabinet renovation cost',searchVol:500,cpc:4.62,category:'Partial Kitchen (Cabinets)'},
  {keyword:'full kitchen remodel cost',searchVol:500,cpc:10.04,category:'Full Kitchen Renovation'},
  {keyword:'kitchen cabinet resurfacing cost',searchVol:500,cpc:6.10,category:'Partial Kitchen (Cabinets)'},
  {keyword:'new kitchen renovation',searchVol:50,cpc:10.24,category:'Full Kitchen Renovation'},
  {keyword:'tub to shower conversion',searchVol:50000,cpc:11.58,category:'Full Bathroom Renovation'},
  {keyword:'bathtub to shower conversion',searchVol:50000,cpc:11.58,category:'Full Bathroom Renovation'},
  {keyword:'bathroom tub to shower conversion',searchVol:50000,cpc:11.58,category:'Full Bathroom Renovation'},
  {keyword:'converting a tub into a shower',searchVol:50000,cpc:11.58,category:'Full Bathroom Renovation'},
  {keyword:'shower to bathtub conversion',searchVol:50000,cpc:11.58,category:'Full Bathroom Renovation'},
  {keyword:'kitchen contractors near me',searchVol:5000,cpc:12.04,category:'Full Kitchen Renovation'},
  {keyword:'kitchen upgrade near me',searchVol:500,cpc:12.29,category:'Full Kitchen Renovation'},
  {keyword:'best kitchen remodelers near me',searchVol:5000,cpc:12.51,category:'Full Kitchen Renovation'},
  {keyword:'kitchen cabinet contractor',searchVol:500,cpc:7.60,category:'Partial Kitchen (Cabinets)'},
  {keyword:'new kitchen remodel cost',searchVol:50,cpc:12.64,category:'Full Kitchen Renovation'},
  {keyword:'new kitchen renovation cost',searchVol:50,cpc:12.64,category:'Full Kitchen Renovation'},
  {keyword:'kitchen remodel designer near me',searchVol:500,cpc:13.57,category:'Full Kitchen Renovation'},
  {keyword:'bathroom remodel near me',searchVol:500000,cpc:17.62,category:'Full Bathroom Renovation'},
  {keyword:'bathroom renovations near me',searchVol:500000,cpc:17.62,category:'Full Bathroom Renovation'},
  {keyword:'bath renovation near me',searchVol:500000,cpc:17.62,category:'Full Bathroom Renovation'},
  {keyword:'kitchen countertop remodel cost',searchVol:500,cpc:8.64,category:'Partial Kitchen (Cabinets)'},
  {keyword:'kitchen tune up prices',searchVol:50,cpc:8.62,category:'Partial Kitchen (Cabinets)'},
  {keyword:'kitchen renewal',searchVol:500,cpc:9.11,category:'Partial Kitchen (Cabinets)'},
  {keyword:'kitchen pantry remodel',searchVol:500,cpc:9.36,category:'Partial Kitchen (Cabinets)'},
  {keyword:'kitchen and bath companies near me',searchVol:500,cpc:15.70,category:'Full Kitchen Renovation'},
  {keyword:'kitchen and bath remodeling near me',searchVol:5000,cpc:16.18,category:'Full Kitchen Renovation'},
  {keyword:'kitchen and bathroom remodel near me',searchVol:5000,cpc:16.18,category:'Full Kitchen Renovation'},
  {keyword:'kitchen and bath renovation near me',searchVol:500,cpc:16.18,category:'Full Kitchen Renovation'},
  {keyword:'kitchen and bath remodel near me',searchVol:500,cpc:16.18,category:'Full Kitchen Renovation'},
  {keyword:'kitchen remodelers in my area',searchVol:500,cpc:17.21,category:'Full Kitchen Renovation'},
  {keyword:'kitchen renewal cost',searchVol:50,cpc:11.00,category:'Partial Kitchen (Cabinets)'},
  {keyword:'best kitchen and bath remodelers near me',searchVol:5000,cpc:19.36,category:'Full Kitchen Renovation'},
  {keyword:'kitchen tune up near me',searchVol:500,cpc:12.05,category:'Partial Kitchen (Cabinets)'},
  {keyword:'kitchen tune up cost',searchVol:50,cpc:13.21,category:'Partial Kitchen (Cabinets)'},
  {keyword:'kitchen floor remodel',searchVol:500,cpc:22.50,category:'Full Kitchen Renovation'},
  {keyword:'kitchen cabinet makeover near me',searchVol:500,cpc:13.99,category:'Partial Kitchen (Cabinets)'},
  {keyword:'kitchen and bath restoration',searchVol:50,cpc:25.45,category:'Full Kitchen Renovation'},
  {keyword:'top kitchen remodelers near me',searchVol:50,cpc:28.27,category:'Full Kitchen Renovation'},
  {keyword:'reasonable kitchen remodel',searchVol:50,cpc:28.66,category:'Full Kitchen Renovation'},
  {keyword:'kitchen cabinet refurbishing near me',searchVol:50,cpc:19.54,category:'Partial Kitchen (Cabinets)'},
  {keyword:'kitchen renewal near me',searchVol:50,cpc:20.04,category:'Partial Kitchen (Cabinets)'},
  {keyword:'small bathroom remodel cost',searchVol:5000,cpc:7.28,category:'Small Bathroom Renovation'},
  {keyword:'one day bathroom remodel',searchVol:5000,cpc:22.10,category:'Full Bathroom Renovation'}
];



const contractorCapacity = {
  'Roofing': 25,
  'Kitchen & Bathroom Remodeling': 4,
  'HVAC': 30,
  'Concrete': 10,
  'Handyman Services': 100,
  'Pool Services': 15,
  'Deck & Outdoor': 12,
  'Flooring': 20,
  'Pressure Washing': 40,
  'General Contracting': 8,
};

    </script>
    <script>
        // Average job values
        const avgJobValues = {
            'Kitchen & Bathroom Remodeling': 28500,
            'Roofing': 17500,
            'HVAC': 7250,
            'Flooring': 9000,
            'Concrete': 5500,
            'Deck & Outdoor': 7000,
            'Pool Services': 10500,
            'Pressure Washing': 500,
            'Handyman Services': 400,
            'General Contracting': 15000
        };

        // Intelligent keyword analysis
        function analyzeKeyword(keyword) {
            const kw = keyword.toLowerCase();
            let intentScore = 50; // Start at 50 (neutral baseline)
            let projectSize = 100; // Start at 100%
            
            // PREMIUM INTENT QUALIFIERS (95-100 range)
            // "best bathroom contractor near me", "elite roofing companies near me"
            const hasPremiumQualifier = kw.includes('best ') || kw.includes('top ') || kw.includes('elite ') || 
                                       kw.includes('premium ') || kw.includes('rated ') || kw.includes('affordable ');
            const hasContractorTerm = kw.includes('contractor') || kw.includes('companies') || kw.includes('company');
            const hasLocalIntent = kw.includes('near me');
            
            if (hasPremiumQualifier && hasContractorTerm && hasLocalIntent) {
                intentScore = 98; // Highest intent: researching best local contractors
            }
            // VERY HIGH INTENT (85-94 range)
            else if (hasLocalIntent && hasContractorTerm) {
                intentScore = 92; // "bathroom contractor near me"
            }
            else if (hasLocalIntent && (kw.includes('repair') || kw.includes('fix') || kw.includes('remodel') || kw.includes('renovation'))) {
                intentScore = 88; // "bathroom remodel near me", "ac repair near me"
            }
            else if ((kw.includes('emergency') || kw.includes('urgent')) && (kw.includes('repair') || kw.includes('fix'))) {
                intentScore = 85; // "emergency ac repair" - urgent need
            }
            // HIGH INTENT (75-84 range) - Specific repairs & urgent needs
            else if ((kw.includes('crack') || kw.includes('leak') || kw.includes('broken')) && 
                     (kw.includes('repair') || kw.includes('fix'))) {
                intentScore = 80; // "concrete crack repair", "roof leak repair" - specific problem to solve
            }
            else if (kw.includes('repair') && (kw.includes('deck') || kw.includes('pool') || kw.includes('driveway'))) {
                intentScore = 78; // "pool decking repair" - specific repair need
            }
            else if (kw.includes('emergency') || kw.includes('urgent')) {
                intentScore = 75; // Any emergency/urgent = high intent
            }
            // COST/PRICE QUERIES - Heavily impacted by Google AI Overviews
            else if ((kw.includes('cost') || kw.includes('price') || kw.includes('pricing')) && hasLocalIntent) {
                intentScore = 55; // "bathroom remodel cost near me" - AI answers generic, but local intent shows readiness for custom quote
            }
            else if ((kw.includes('cost') || kw.includes('price') || kw.includes('pricing')) && 
                     (kw.includes('average') || kw.includes('typical'))) {
                intentScore = 35; // "average bathroom remodel cost" - pure research, Google AI kills this
            }
            else if (kw.includes('cost') || kw.includes('price') || kw.includes('pricing')) {
                intentScore = 42; // Generic cost queries - Google AI Overviews answer this directly, very low CTR
            }
            else if (kw.includes('how much')) {
                intentScore = 40; // "how much does X cost" - Same issue as cost queries, AI answers directly
            }
            // MEDIUM-HIGH INTENT (55-64 range)
            else if (hasLocalIntent) {
                intentScore = 62; // Any "near me" shows local intent
            }
            else if (kw.includes('contractor') || hasContractorTerm) {
                intentScore = 60; // Looking for contractors
            }
            else if (kw.includes('service') || kw.includes('services')) {
                intentScore = 58;
            }
            else if (kw.includes('install') || kw.includes('replace') || kw.includes('installation')) {
                intentScore = 56;
            }
            else if (kw.includes('repair') || kw.includes('fix')) {
                intentScore = 55; // Generic repair without specifics
            }
            else if (kw.includes('remodel') || kw.includes('renovation')) {
                intentScore = 54;
            }
            
            // LOW INTENT SIGNALS - Deductions from baseline
            if (kw.includes('diy')) intentScore -= 35;
            if (kw.includes('how to')) intentScore -= 40;
            if (kw.includes('video') || kw.includes('tutorial')) intentScore -= 30;
            if (kw.includes('picture') || kw.includes('photo') || kw.includes('image')) intentScore -= 35;
            if (kw.includes('idea') || kw.includes('inspiration') || kw.includes('design')) intentScore -= 30;
            if (kw.includes('what is') || kw.includes('why ') || kw.includes('when ')) intentScore -= 35;
            
            // PRODUCT/MATERIAL ONLY (not service)
            if (kw.includes('home depot') || kw.includes('lowes') || kw.includes('amazon')) intentScore -= 30;
            if (kw.includes('rustoleum') || kw.includes('quikrete') || kw.includes('sikaflex')) intentScore -= 25;
            if (kw.includes('for sale') || kw.includes('buy ') || kw.includes('purchase')) intentScore -= 20;
            
            // PROJECT SIZE ADJUSTMENTS
            
            // COMBO PROJECTS - Multiple services = Higher value (140-200% of base)
            // Kitchen + Bathroom combos (2 full remodels = ~$40k-$57k instead of $28.5k)
            if ((kw.includes('kitchen') && kw.includes('bath')) || 
                (kw.includes('kitchen') && kw.includes('bathroom'))) {
                projectSize = 140; // Kitchen + Bathroom = 1.4x base (represents ~$40k project)
            }
            // Painting + Flooring combo
            else if (kw.includes('painting') && kw.includes('flooring')) {
                projectSize = 150; // Two services
            }
            // Soffits + Fascia (often done together in roofing)
            else if (kw.includes('soffit') && kw.includes('fascia')) {
                projectSize = 110; // Slightly larger roofing project
            }
            // Deck with Pool (premium combo)
            else if (kw.includes('deck') && kw.includes('pool')) {
                projectSize = 180; // High-value combo project
            }
            
            // Small repairs (10-30% of full job)
            else if (kw.includes('crack') || kw.includes('leak')) projectSize = 15;
            else if (kw.includes('patch')) projectSize = 20;
            else if (kw.includes('seal') && !kw.includes('reseal')) projectSize = 15;
            else if (kw.includes('minor')) projectSize = 25;
            else if (kw.includes('small')) projectSize = 30;
            
            // Partial jobs (30-60%)
            else if (kw.includes('cabinet') && kw.includes('kitchen')) projectSize = 40;
            else if (kw.includes('counter') && !kw.includes('contractor')) projectSize = 35;
            else if (kw.includes('backsplash')) projectSize = 25;
            else if (kw.includes('shower') && !kw.includes('full')) projectSize = 45;
            else if (kw.includes('tub')) projectSize = 30;
            else if (kw.includes('vanity')) projectSize = 20;
            else if (kw.includes('tile') && !kw.includes('retile')) projectSize = 40;
            else if (kw.includes('vent') || kw.includes('ventilation')) projectSize = 15;
            else if (kw.includes('gutter')) projectSize = 20;
            else if (kw.includes('cleaning') || kw.includes('clean')) projectSize = 10;
            else if (kw.includes('wash')) projectSize = 10;
            
            // Medium projects (60-85%)
            else if (kw.includes('resurface')) projectSize = 65;
            else if (kw.includes('refinish')) projectSize = 60;
            else if (kw.includes('recoat')) projectSize = 50;
            
            // Clamp values
            intentScore = Math.max(5, Math.min(100, intentScore));
            projectSize = Math.max(5, Math.min(200, projectSize)); // Allow up to 200% for combo projects
            
            return { intentScore, projectSize };
        }

        function getParams() {
            return {
                ctr: parseFloat(document.getElementById('ctr').value) / 100 || 0.05,
                cvr: parseFloat(document.getElementById('cvr').value) / 100 || 0.065,
                closeRate: parseFloat(document.getElementById('close-rate').value) / 100 || 0.35,
                commissionRate: parseFloat(document.getElementById('commission-rate').value) / 100 || 0.15
            };
        }

        function calculateCostPerJob(cpc, params) {
            const clicksPerLead = 1 / params.cvr;
            const leadsPerJob = 1 / params.closeRate;
            const totalClicksPerJob = clicksPerLead * leadsPerJob;
            return totalClicksPerJob * cpc;
        }

        function init() {
            console.log('Initializing calculator...');
            console.log('Keywords loaded:', keywordData ? keywordData.length : 0);
            
            if (!keywordData || keywordData.length === 0) {
                alert('ERROR: No keyword data found!');
                return;
            }
            
            populateCategoryFilter();
            
            // Add event listeners to parameters
            ['ctr', 'cvr', 'close-rate', 'commission-rate'].forEach(id => {
                document.getElementById(id).addEventListener('input', () => {
                    generateCapacityCards();
                    renderTable();
                });
            });
            
            // Add event listeners to filters
            document.getElementById('category-filter').addEventListener('change', renderTable);
            document.getElementById('profit-filter').addEventListener('change', renderTable);
            document.getElementById('sort-by').addEventListener('change', renderTable);
            
            console.log('Generating capacity cards...');
            generateCapacityCards();
            console.log('Rendering table...');
            renderTable();
            console.log('Initialization complete!');
        }

        function populateCategoryFilter() {
            const categories = [...new Set(keywordData.map(k => k.category))];
            const select = document.getElementById('category-filter');
            categories.forEach(cat => {
                const option = document.createElement('option');
                option.value = cat;
                option.textContent = cat;
                select.appendChild(option);
            });
        }

        function generateCapacityCards() {
            const params = getParams();
            const container = document.getElementById('capacity-cards');
            container.innerHTML = '';
            
            const categories = [...new Set(keywordData.map(k => k.category))];
            
            categories.forEach(category => {
                const categoryKeywords = keywordData.filter(k => k.category === category);
                const capacity = contractorCapacity[category] || 10;
                const jobValue = avgJobValues[category] || 10000;
                
                // Find the BEST (lowest cost) keyword for this category
                let bestKeyword = null;
                let lowestCost = Infinity;
                
                categoryKeywords.forEach(kw => {
                    const costPerJob = calculateCostPerJob(kw.cpc, params);
                    if (costPerJob < lowestCost) {
                        lowestCost = costPerJob;
                        bestKeyword = kw;
                    }
                });
                
                if (!bestKeyword) return;
                
                const costPerJob = calculateCostPerJob(bestKeyword.cpc, params);
                const clicksPerLead = 1 / params.cvr;
                const leadsPerJob = 1 / params.closeRate;
                const clicksPerJob = clicksPerLead * leadsPerJob;
                const costPerLead = clicksPerLead * bestKeyword.cpc;
                const commission = jobValue * params.commissionRate;
                const profitPerJob = commission - costPerJob;
                
                // Calculate for full capacity
                const totalInvestment = costPerJob * capacity;
                const totalRevenue = commission * capacity;
                const totalProfit = profitPerJob * capacity;
                
                const card = document.createElement('div');
                card.className = 'capacity-card';
                card.innerHTML = `
                    <h3>${category}</h3>
                    <div class="capacity-metric">
                        <span class="metric-label">Contractor Capacity:</span>
                        <span class="metric-value">${capacity} jobs/month</span>
                    </div>
                    <div class="capacity-metric">
                        <span class="metric-label">‚≠ê Cheapest Keyword:</span>
                        <span class="metric-value" style="font-size: 0.85em;">${bestKeyword.keyword}</span>
                    </div>
                    <div class="capacity-metric">
                        <span class="metric-label">CPC for this keyword:</span>
                        <span class="metric-value">$${bestKeyword.cpc.toFixed(2)}</span>
                    </div>
                    <div class="capacity-metric">
                        <span class="metric-label">Clicks per Lead:</span>
                        <span class="metric-value">${clicksPerLead.toFixed(1)} clicks</span>
                    </div>
                    <div class="capacity-metric">
                        <span class="metric-label">Cost Per Lead:</span>
                        <span class="metric-value">$${costPerLead.toFixed(0)}</span>
                    </div>
                    <div class="capacity-metric">
                        <span class="metric-label">Leads per Job:</span>
                        <span class="metric-value">${leadsPerJob.toFixed(1)} leads</span>
                    </div>
                    <div class="capacity-metric">
                        <span class="metric-label">Cost Per Job:</span>
                        <span class="metric-value">$${costPerJob.toFixed(0)}</span>
                    </div>
                    <div class="capacity-metric">
                        <span class="metric-label">Your Commission:</span>
                        <span class="metric-value">$${commission.toFixed(0)}</span>
                    </div>
                    <div class="capacity-metric">
                        <span class="metric-label">Profit Per Job:</span>
                        <span class="metric-value ${profitPerJob > 0 ? 'positive' : 'negative'}">
                            $${profitPerJob.toFixed(0)}
                        </span>
                    </div>
                    <div class="capacity-metric">
                        <span class="metric-label">Monthly Investment:</span>
                        <span class="metric-value">$${totalInvestment.toFixed(0)}/month</span>
                    </div>
                    <div class="capacity-metric">
                        <span class="metric-label">Monthly Revenue:</span>
                        <span class="metric-value">$${totalRevenue.toFixed(0)}/month</span>
                    </div>
                    <div class="capacity-metric">
                        <span class="metric-label">Monthly Profit:</span>
                        <span class="metric-value ${totalProfit > 0 ? 'positive' : 'negative'}">
                            $${totalProfit.toFixed(0)}/month
                        </span>
                    </div>
                `;
                container.appendChild(card);
            });
        }

        function filterAndSortData() {
            const params = getParams();
            const category = document.getElementById('category-filter').value;
            const profitFilter = document.getElementById('profit-filter').value;
            const sortBy = document.getElementById('sort-by').value;
            
            // Filter
            let filtered = keywordData.filter(k => {
                if (category !== 'all' && k.category !== category) return false;
                
                const jobValue = avgJobValues[k.category] || 10000;
                const costPerJob = calculateCostPerJob(k.cpc, params);
                const commission = jobValue * params.commissionRate;
                const profitPerJob = commission - costPerJob;
                
                if (profitFilter === 'profitable' && profitPerJob <= 0) return false;
                if (profitFilter === 'unprofitable' && profitPerJob > 0) return false;
                
                return true;
            });
            
            // Add calculated fields
            filtered = filtered.map(k => {
                const analysis = analyzeKeyword(k.keyword);
                const baseJobValue = avgJobValues[k.category] || 10000;
                const adjustedJobValue = baseJobValue * (analysis.projectSize / 100);
                const costPerJob = calculateCostPerJob(k.cpc, params);
                
                // Apply intent score to conversion rate (lower intent = fewer conversions)
                const intentMultiplier = analysis.intentScore / 100;
                const adjustedCostPerJob = costPerJob / intentMultiplier;
                
                const commission = adjustedJobValue * params.commissionRate;
                const profitPerJob = commission - adjustedCostPerJob;
                const trueROAS = adjustedCostPerJob > 0 ? (commission / adjustedCostPerJob) - 1 : 0;
                
                return {
                    ...k,
                    intentScore: analysis.intentScore,
                    projectSizePercent: analysis.projectSize,
                    baseJobValue,
                    adjustedJobValue,
                    costPerJob: adjustedCostPerJob,
                    commission,
                    profitPerJob,
                    trueROAS
                };
            });
            
            // Sort
            filtered.sort((a, b) => {
                switch(sortBy) {
                    case 'intent-desc': return b.intentScore - a.intentScore;
                    case 'roas-desc': return b.trueROAS - a.trueROAS;
                    case 'cost-asc': return a.costPerJob - b.costPerJob;
                    case 'cost-desc': return b.costPerJob - a.costPerJob;
                    case 'profit-desc': return b.profitPerJob - a.profitPerJob;
                    case 'size-desc': return b.projectSizePercent - a.projectSizePercent;
                    case 'volume-desc': return b.searchVol - a.searchVol;
                    case 'cpc-asc': return a.cpc - b.cpc;
                    default: return 0;
                }
            });
            
            return filtered;
        }

        function renderTable() {
            const data = filterAndSortData();
            const tbody = document.getElementById('table-body');
            tbody.innerHTML = '';
            
            data.forEach(row => {
                const tr = document.createElement('tr');
                const intentColor = row.intentScore >= 75 ? '#27ae60' : row.intentScore >= 50 ? '#f39c12' : '#e74c3c';
                const sizeColor = row.projectSizePercent >= 80 ? '#27ae60' : row.projectSizePercent >= 50 ? '#f39c12' : '#e74c3c';
                const roasColor = row.trueROAS > 0 ? '#27ae60' : row.trueROAS > -0.5 ? '#f39c12' : '#e74c3c';
                
                tr.innerHTML = `
                    <td>${row.category}</td>
                    <td><strong>${row.keyword}</strong></td>
                    <td>${row.searchVol.toLocaleString()}</td>
                    <td>$${row.cpc.toFixed(2)}</td>
                    <td style="background-color: ${intentColor}22; font-weight: bold; color: ${intentColor};">${row.intentScore}</td>
                    <td style="background-color: ${sizeColor}22; font-weight: bold; color: ${sizeColor};">${row.projectSizePercent}%</td>
                    <td>$${row.adjustedJobValue.toLocaleString()}</td>
                    <td><strong>$${row.costPerJob.toFixed(0)}</strong></td>
                    <td>$${row.commission.toFixed(0)}</td>
                    <td><span class="${row.profitPerJob > 0 ? 'profitable' : 'unprofitable'}">
                        $${row.profitPerJob.toFixed(0)}
                    </span></td>
                    <td style="background-color: ${roasColor}22; font-weight: bold; color: ${roasColor};">${(row.trueROAS * 100).toFixed(0)}%</td>
                `;
                tbody.appendChild(tr);
            });
        }

        init();
    </script>
</body>
</html>
